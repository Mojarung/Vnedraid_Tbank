# IT-решение: Финансовый новостной ИИ-ассистент

## Определение задачи

Разработать прототип новостного агрегатора, суммаризатора и интерпретатора на базе искусственного интеллекта. Основная цель — предоставлять российским розничным трейдерам своевременную, актуальную и полезную информацию из широкого круга финансовых новостных источников. Это позволит им принимать более обоснованные торговые решения, повышая их эффективность и потенциальную прибыльность. Решение должно быть спроектировано как сервис, который потенциально может быть интегрирован в существующую цифровую экосистему Т-Банка.

## Основные функции

1.  **Агрегация новостей из нескольких источников**:
    - Автоматический сбор данных из настроенных источников: крупные новостные агентства (Интерфакс, РБК), RSS-ленты, публичные Telegram-каналы и финансовые сайты (например, новостные разделы TradingView).
    - Внедрение надежного механизма дедупликации для обеспечения чистой, неповторяющейся новостной ленты.
2.  **Фильтрация по тикерам**:
    - Позволить пользователям выбирать и отслеживать определенные компании, торгующиеся на российском фондовом рынке.
    - Основная новостная лента должна фильтроваться, чтобы показывать только новости, относящиеся к выбранным пользователем тикерам.
3.  **Суммаризация на базе ИИ**:
    - Интеграция с LLM для создания кратких, легко усваиваемых резюме для каждой новостной статьи.
    - Резюме должно передавать суть новости, не требуя от пользователя чтения полного текста.
4.  **Двойной формат отображения**:
    - **«Ежедневная газета»**: Утренний брифинг, доставляемый до открытия рынка, с обзором ключевых ночных и утренних новостей для портфеля пользователя.
    - **«Живая лента»**: Постоянно обновляемый поток новостей и аналитики в течение дня.
5.  **Простой пользовательский интерфейс**:
    - Чистый, интуитивно понятный клиент, предлагаемый в виде Telegram Mini App для высокой доступности, но адаптируемый под веб-приложение или бота.
    - Акцент на читабельности и простоте навигации.

## Инновационные улучшения (Расширенная версия)

1.  **Продвинутая AI-интерпретация и прогнозирование**:
    - Выйти за рамки простого резюмирования и предоставлять интерпретацию потенциального влияния новости (например, «Это бычий сигнал для LKOH, потому что...»).
    - Использовать LLM для генерации краткосрочного прогноза настроений (Позитивный, Негативный, Нейтральный) и **оценки уверенности** для каждой новости.

2.  **Семантический поиск и «Вопрос-Ответ»**:
    - Внедрить функцию, позволяющую пользователям задавать вопросы на естественном языке о рынке или конкретной акции (например, «Что нового по дивидендной политике Роснефти?»). Система будет искать в своих агрегированных данных и предоставлять синтезированный ответ.

3.  **Движок макроэкономического контекста**:
    - Автоматически связывать новости отдельных компаний с более широкими макроэкономическими событиями (например, решения ЦБ по ключевой ставке, данные по инфляции, изменения цен на нефть).
    - Предоставлять краткую сводку «Почему это важно сейчас», объясняющую, как макроэкономический фон усиливает или ослабляет влияние новости.

4.  **Бэктестинг стратегий на новостях**:
    - Позволить пользователям симулировать простые торговые стратегии на основе исторических новостных настроений.
    - Пример запроса: «Покажи гипотетическую доходность, если бы я покупал Сбер каждый раз при появлении 'сильно позитивной' новости за последний год и продавал через 7 дней».

5.  **Анализ корпоративных отчетов и сделок инсайдеров**:
    - Интегрировать официальные источники раскрытия корпоративной информации (например, e-disclosure.ru).
    - Использовать ИИ для резюмирования объемных квартальных/годовых отчетов и выделения ключевых изменений по сравнению с предыдущими периодами.
    - Отмечать и резюмировать отчеты о сделках инсайдеров.

6.  **Аналитика цепочек поставок и конкурентов**:
    - Определять ключевых поставщиков, клиентов и конкурентов компании.
    - Выводить новости, связанные с этими организациями, которые могут оказать косвенное влияние (например, «У ключевого поставщика НЛМК возникли проблемы с производством, что может повлиять на выпуск стали»).

7.  **Пульс мнений экспертов и соцсетей**:
    - Агрегировать и анализировать мнения из отобранного списка финансовых экспертов на платформах, таких как Telegram или «Пульс» (соцсеть Тинькофф).
    - Показывать консенсус-мнение и выявлять противоположные точки зрения, предоставляя ссылки на исходные посты.

8.  **Персонализированное обнаружение аномалий и событий**:
    - Разработать алгоритм для обнаружения необычных всплесков объема новостей или настроений, *специально адаптированный к портфелю пользователя*.
    - Генерировать оповещения типа: «Необычно высокий объем негативных новостей по YNDX за последние 3 часа по сравнению со среднесуточным значением за 30 дней».

## Технические аспекты

- **Архитектура**: **Микросервисная архитектура**.
    - `Data-Ingestion-Service`: Набор воркеров для скрапинга и парсинга различных источников. Работает независимо и может масштабироваться.
    - `NLP-Processor-Service`: Обрабатывает вызовы LLM для резюмирования, тегирования и анализа. Может масштабироваться в зависимости от нагрузки на обработку.
    - `API-Gateway`: Основной бэкенд на FastAPI, который обслуживает данные для клиента, обрабатывая запросы пользователей и бизнес-логику.
- **База данных**: **PostgreSQL** для структурированных данных (новости, тикеры, пользователи). Использовать **Redis** для кэширования ответов API, данных сессий и в качестве брокера сообщений для фоновых задач. Рассмотреть векторную базу данных, такую как **Pinecone** или **Milvus**, при реализации семантического поиска.
- **API**:
    - Бэкенд будет предоставлять **RESTful API** для клиента.
    - Интеграция со сторонними **LLM API** (OpenAI, Anthropic и т.д.).
- **Сторонние интеграции**:
    - `Telethon/Pyrogram` для Telegram.
    - `feedparser` для RSS.
    - `BeautifulSoup/Scrapy` для веб-скрапинга.

## Масштабируемость и производительность

- **Асинхронные операции**: Весь стек бэкенда (FastAPI, httpx) должен быть асинхронным для эффективной обработки большого количества операций ввода-вывода при сборе данных и запросах к API.
- **Фоновые воркеры**: Использовать **Celery** или **Dramatiq** с Redis/RabbitMQ для выгрузки ресурсоемких задач, таких как скрапинг и NLP-обработка, из основного потока API. Это обеспечит отзывчивость API.
- **Балансировка нагрузки**: Развертывать сервисы в Docker-контейнерах под управлением Kubernetes (или Docker Swarm), что позволит горизонтально масштабировать каждый микросервис за балансировщиком нагрузки (например, Nginx).
- **Масштабирование базы данных**: Внедрить реплики чтения для базы данных PostgreSQL для распределения нагрузки на чтение, которая составит большую часть трафика.
- **Кэширование**: Агрессивно кэшировать эндпоинты API (например, «ежедневная газета», популярные новостные ленты) в Redis для сокращения обращений к базе данных и улучшения времени отклика.

## Меры безопасности

- **Аутентификация/Авторизация**: Хотя в первоначальном задании указано, что аутентификация не требуется, для будущего развития стоит ее запланировать. Внедрить OAuth2 с JWT-токенами, если будут добавлены учетные записи пользователей.
- **Безопасность API**: Использовать API-ключи для доступа к чувствительным или ограниченным по частоте запросов эндпоинтам. Внедрить ограничение частоты запросов для предотвращения злоупотреблений.
- **Валидация ввода**: Использовать модели Pydantic в FastAPI для строгой валидации всех входящих данных для предотвращения атак инъекций.
- **Управление секретами**: Хранить все секреты (API-ключи, учетные данные БД) в переменных окружения или в сервисе управления секретами (например, HashiCorp Vault или AWS Secrets Manager), а не в коде.
- **Соответствие требованиям**: Обработка данных должна быть спроектирована с учетом конфиденциальности, хотя в данном случае объем персональных данных минимален, если не будут добавлены учетные записи пользователей.

## Пользовательский опыт (UX)

- **Выбор клиента**: **Telegram Mini App (TMA)** — отличный выбор для прототипа. Он мобильно-ориентирован, не требует отдельной установки и плавно интегрируется в существующий рабочий процесс пользователя.
- **UI/UX**:
    - **Адаптивный дизайн Mobile-First**.
    - Использовать чистый, современный UI-кит, такой как **Shadcn UI** с Tailwind CSS.
    - Внедрить **скелетные загрузчики** для обратной связи во время загрузки данных.
    - Реализовать **темную тему**, которую часто предпочитают в финансовых приложениях.
    - Минимизировать взаимодействия. Основная ценность — доставка информации, а не сложный пользовательский ввод.

## Эффективность затрат и ресурсов

- **Облачные решения**: Развертывание на экономически выгодном облачном провайдере (например, DigitalOcean, Hetzner или бесплатные уровни облачных провайдеров для прототипа).
- **Технологический стек**: Python/FastAPI и React — это open-source технологии с низким порогом входа.
- **Затраты на LLM**: Это будут основные операционные расходы.
    - Начать с более дешевой/быстрой модели (например, GPT-3.5-Turbo) для прототипа.
    - Внедрить кэширование результатов LLM (например, кэшировать резюме для конкретного ID статьи), чтобы избежать повторной обработки того же контента.
    - Исследовать возможность тонкой настройки меньших, open-source моделей для конкретных задач, таких как анализ настроений, для сокращения вызовов API.

## Тестирование и QA

- **Модульное тестирование**: `pytest` для логики бэкенда, `Vitest`/`React Testing Library` для компонентов фронтенда. Стремиться к >80% покрытию кода для критической логики.
- **Интеграционное тестирование**: Тестировать взаимодействие между сервисами (API Gateway -> Processor -> DB). Использовать Docker Compose для создания изолированной тестовой среды.
- **Сквозное (E2E) тестирование**: Использовать фреймворк, такой как Playwright или Cypress, для тестирования ключевых пользовательских сценариев (например, выбор тикера и обновление ленты).
- **Среда для стейджинга**: Поддерживать среду для стейджинга, которая зеркалирует производственную, для окончательного тестирования перед развертыванием.

## Развертывание и поддержка

- **CI/CD**: Использовать **GitHub Actions** для автоматизации тестирования и развертывания.
- **Контейнеризация**: **Докеризировать** все сервисы для обеспечения согласованности между средами разработки, стейджинга и производства.
- **Оркестрация**: Использовать **docker compose** для простоты на начальном этапе. Запланировать миграцию на **Kubernetes**, если сервис будет расти и потребует более сложного масштабирования и управления.
- **Мониторинг**: Внедрить логирование (например, с помощью `loguru` в Python) и отправку логов в централизованный сервис (например, стек ELK или решение для логирования от облачного провайдера). Настроить мониторинг доступности и дашборды производительности (например, с помощью Prometheus/Grafana).